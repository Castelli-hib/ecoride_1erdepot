{% extends 'base.html.twig' %}

{% block title %}M'inscrire{% endblock %}

{% block javascripts %}
    {# ImportMap officiel (si tout fonctionne) #}
    {# {{ importmap('register') }} #}

    {# Fallback simple et fiable, Charge le fichier sans passer par importmap #}
    <script type="module" src="{{ asset('assets/js/register.js') }}"></script>
{% endblock %}

{% block body %}
<div class="container my-4">
    <h1 class="mb-4 text-left">M'inscrire</h1>

    {{ form_start(registrationForm, {'attr': {'id': 'registration_form'}}) }}

    <section class="section-display left-content d-flex gap-4 flex-wrap">
        <div class="flex-fill">
            <h4>Informations personnelles :</h4>
            {{ form_row(registrationForm.firstname) }}
            {{ form_row(registrationForm.lastname) }}
            {{ form_row(registrationForm.username) }}
            {{ form_row(registrationForm.email) }}
            {{ form_row(registrationForm.phoneNumber) }}
        </div>

        <div class="flex-fill">
            <h4>Adresse :</h4>
            {{ form_row(registrationForm.street) }}
            {{ form_row(registrationForm.addressComplement) }}
            {{ form_row(registrationForm.postalCode) }}
            {{ form_row(registrationForm.city) }}
        </div>
    </section>

    <hr class="my-4">

    <div class="mb-3">
        <h4>Choisissez votre rôle :</h4>
        {{ form_row(registrationForm.roles) }}
    </div>

    <div class="mb-3">
			{{ form_row(registrationForm.plainPassword, { label: 'Mot de passe' }) }}
			<p class="small mt-2">
				Complexité du mot de passe :
				<span id="entropy" class="text-red fw-bold">Très faible</span>
				<div class="password-strength-bar">
					<div id="password-bar" class="bar"></div>
				</div>
				(Minimum requis :
				<strong>Fort</strong>
				— au moins 8 caractères, dont majuscule, minuscule, chiffre, caractère spécial)
			</p>
		</div>

    <div class="mb-3">
        {{ form_row(registrationForm.agreeTerms) }}
    </div>

    <button type="submit" id="submit-button" class="btn btn-primary" form="registration_form" disabled> 
        S'inscrire
    </button>

    {{ form_end(registrationForm) }}

    <p class="mt-3">
        Déjà inscrit ? <a href="{{ path('app_login') }}">Se connecter</a>
    </p>
</div>
{% endblock %}
